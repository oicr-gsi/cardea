# QC Gate ETL API Development Guide

QC Gate ETL API is a Spring Boot web app.

- [Auto-configuration](https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/using-boot-auto-configuration.html)
  automates a lot of application and library setup while allowing you to override any of its
  defaults
- The [IoC container](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans)
  simplifies the creation of application components via dependency injection
- Controller classes respond to web requests

## Configuration

App config is in `/resources/application.yml`. The properties in this file can be overridden
using command-line parameters, system variables, or an external properties file. See the
[README](/README.md) for more information on the external properties file.

## Debugging

Example: Run the server with debugging enabled on port 8000 and wait for debugger connection before
starting:

```
mvn clean spring-boot:run -Dspring-boot.run.jvmArguments="-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=8000"
```

A VSCode launch configuration named "Debug local QC Gate ETL API" is provided to connect to this.

## Code Formatting

QC Gate ETL API has formatters configured for Java, HTML, and TypeScript in VSCode. For these to work, you
must have the following extensions installed:

- Language Support for Java(TM) by Red Hat
- Prettier - Code Formatter

## Data Loading

QC Gate ETL API serves QC Gate data generated by QC Gate ETL. The data directory is specified by the
`datadirectory` property in `application.properties`. The
[CaseLoader](qcgateetlapi-server/src/main/java/ca/on/oicr/qcgateetlapi/CaseLoader.java) class is responsible for loading the
data from file. [CaseService](qcgateetlapi-server/src/main/java/ca/on/oicr/qcgateetlapi/service/CaseService.java) polls the
directory for changes, invokes `CaseLoader` to reload the data when appropriate, and maintains a
cache of the data to provide to other parts of the application.
